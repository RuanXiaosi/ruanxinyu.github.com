<!DOCTYPE html>
<html>
<head>
    

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="阮新宇的成长记录">
    <meta name="author" content="阮新宇">
    <meta name="keywords" content="飞行手册">
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <title>Ubuntu常见问题操作指导 | RuanXinYu&#39;s Blog | 路漫漫其修远兮，吾将上下而求索</title>

    <meta name="description" content="如何重启网卡重启网卡可以使用ip，ifconfig和service命令，如下所示，推荐使用ip命令。 12345678910# 推荐使用ip命令sudo ip link set enp0s3 downsudo ip link set enp0s3 up# 使用ifconfig命令sudo ifconfig enp0s3 downsudo ifconfig enp0s3 up# 使用service命">
<meta name="keywords" content="飞行手册">
<meta property="og:type" content="article">
<meta property="og:title" content="Ubuntu常见问题操作指导">
<meta property="og:url" content="http://ruanxinyu.github.io/posts/Ubuntu常见问题操作指导/index.html">
<meta property="og:site_name" content="RuanXinYu&#39;s Blog">
<meta property="og:description" content="如何重启网卡重启网卡可以使用ip，ifconfig和service命令，如下所示，推荐使用ip命令。 12345678910# 推荐使用ip命令sudo ip link set enp0s3 downsudo ip link set enp0s3 up# 使用ifconfig命令sudo ifconfig enp0s3 downsudo ifconfig enp0s3 up# 使用service命">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2018-10-14T04:44:45.393Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Ubuntu常见问题操作指导">
<meta name="twitter:description" content="如何重启网卡重启网卡可以使用ip，ifconfig和service命令，如下所示，推荐使用ip命令。 12345678910# 推荐使用ip命令sudo ip link set enp0s3 downsudo ip link set enp0s3 up# 使用ifconfig命令sudo ifconfig enp0s3 downsudo ifconfig enp0s3 up# 使用service命">
    
        <link rel="alternate" type="application/atom+xml" title="RuanXinYu&#39;s Blog" href="/atom.xml">
    
    <link rel="stylesheet" href="/css/style.css">
    <link rel="shortcut icon" href="/img/avatar.png">
</head>
<body class="bg-white">
    <nav class="navbar navbar-expand-md fixed-top navbar-dark bg-dark">
    <a class="navbar-brand" href="/">
        <img src="/img/avatar.png" width="30" height="30" style="border-radius:5px;" alt="">
    </a>
    <button class="navbar-toggler p-0 border-0" type="button" data-toggle="offcanvas">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="navbar-collapse offcanvas-collapse" id="navbarsDefault">
        <ul class="navbar-nav mr-auto">
        
            
                <li class="nav-item">
                    <a class="nav-link" href="/"  >主页</a>
                </li>
            
        
            
                <li class="nav-item">
                    <a class="nav-link" href="/pages/bookmarks"  >书签收藏</a>
                </li>
            
        
            
                <li class="nav-item">
                    <a class="nav-link" href="/pages/questions"  >问题速查</a>
                </li>
            
        
            
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="http://example.com" id="dropdown01" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">博文管理</a>
                    <div class="dropdown-menu" aria-labelledby="dropdown01">
                        
                        <a class="dropdown-item" href="/tags"  >标签</a>
                        
                        <a class="dropdown-item" href="/categories"  >分类</a>
                        
                        <a class="dropdown-item" href="/archives"  >归档</a>
                        
                    </div>
                </li>
            
        
            
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="http://example.com" id="dropdown01" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">关于</a>
                    <div class="dropdown-menu" aria-labelledby="dropdown01">
                        
                        <a class="dropdown-item" href="https://github.com/RuanXinyu" target="_blank" >github</a>
                        
                        <a class="dropdown-item" href="/posts/下一步计划"  >下一步计划</a>
                        
                    </div>
                </li>
            
        
        </ul>
        <form class="form-inline my-2 my-lg-0">
          <input class="form-control mr-sm-2" type="text" placeholder="全文搜索" aria-label="Search">
          <button class="btn btn-outline-success my-2 my-sm-0" type="submit">搜索</button>
        </form>
    </div>
</nav>
    <main role="main" class="container-fluid mt-5">
        <div class="my-3 p-3 bg-white rounded box-shadow">
    <div class="row">
        <div class="col-2 position-fixed border-right" style="overflow-y:auto; height:100%; width:100%">
            <div class="my-3 bg-white rounded box-shadow post-toc">
                <a href="/"><h6 class="text-success">目录：</h6></a><hr class="mt-0">
                <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#如何重启网卡"><span class="toc-text">如何重启网卡</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#如何临时添加-修改-删除IP地址"><span class="toc-text">如何临时添加-修改-删除IP地址</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#如何设置静态IP地址和DNS"><span class="toc-text">如何设置静态IP地址和DNS</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#如何查看和设置DNS"><span class="toc-text">如何查看和设置DNS</span></a></li></ol>
            </div>
        </div>
        <div class="col-10 offset-2">
        <div class="my-3 bg-white rounded box-shadow post-content"><h1 id="如何重启网卡"><a href="#如何重启网卡" class="headerlink" title="如何重启网卡"></a>如何重启网卡</h1><p>重启网卡可以使用<code>ip</code>，<code>ifconfig</code>和<code>service</code>命令，如下所示，推荐使用<code>ip</code>命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 推荐使用ip命令</span></span><br><span class="line">sudo ip link <span class="built_in">set</span> enp0s3 down</span><br><span class="line">sudo ip link <span class="built_in">set</span> enp0s3 up</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用ifconfig命令</span></span><br><span class="line">sudo ifconfig enp0s3 down</span><br><span class="line">sudo ifconfig enp0s3 up</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用service命令，但是不支持最新版的Ubuntu</span></span><br><span class="line">sudo service network restart</span><br></pre></td></tr></table></figure>
<h1 id="如何临时添加-修改-删除IP地址"><a href="#如何临时添加-修改-删除IP地址" class="headerlink" title="如何临时添加-修改-删除IP地址"></a>如何临时添加-修改-删除IP地址</h1><p>可以使用<code>ip</code>和<code>ifconfig</code>命令，如下所示，推荐使用<code>ip</code>命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 推荐使用ip命令</span></span><br><span class="line">sudo ip address add 192.168.1.135/32 dev enp0s3     <span class="comment"># 添加</span></span><br><span class="line">sudo ip address change 192.168.1.135/24 dev enp0s3  <span class="comment"># 修改</span></span><br><span class="line">sudo ip address del 192.168.1.135/24 dev enp0s3     <span class="comment"># 删除</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用ifconfig命令</span></span><br><span class="line">sudo ifconfig eth0 192.168.1.135 netmask 255.255.255.0</span><br></pre></td></tr></table></figure>
<h1 id="如何设置静态IP地址和DNS"><a href="#如何设置静态IP地址和DNS" class="headerlink" title="如何设置静态IP地址和DNS"></a>如何设置静态IP地址和DNS</h1><blockquote>
<p>由于Ubuntu从<code>17.10</code>开始改用<code>netplan</code>方式管理，因此在不同版本设置方式不一样。</p>
</blockquote>
<p><strong>Ubuntu 17.10版本前</strong>，编辑<code>sudo vim /etc/network/interfaces</code>文件，添加如下的内容，然后重启网卡即可。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">auto enp0s3</span><br><span class="line">iface enp0s3 inet static</span><br><span class="line">address 192.168.1.132</span><br><span class="line">netmask 255.255.255.0</span><br><span class="line">gateway 192.168.1.1</span><br><span class="line">dns-nameserver 192.168.1.1</span><br></pre></td></tr></table></figure>
<p><strong> Ubuntu 17.10版本后</strong>，编辑<code>netplan</code>方式的配置文件<code>sudo vim /etc/netplan/50-cloud-init.yaml</code>，设置如下内容，然后执行<code>sudo netplan apply</code>即可立即生效。</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">network:</span></span><br><span class="line"><span class="attr">    ethernets:</span></span><br><span class="line"><span class="attr">        enp0s3:</span>   <span class="comment"># 配置的网卡名称</span></span><br><span class="line"><span class="attr">            dhcp4:</span> <span class="literal">no</span>    <span class="comment"># dhcp4关闭</span></span><br><span class="line"><span class="attr">            dhcp6:</span> <span class="literal">no</span>    <span class="comment"># dhcp6关闭</span></span><br><span class="line"><span class="attr">            addresses:</span> <span class="string">[192.168.1.132/24]</span>   <span class="comment"># 设置本机IP及掩码</span></span><br><span class="line"><span class="attr">            gateway4:</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span>      <span class="comment"># 设置网关</span></span><br><span class="line"><span class="attr">            nameservers:</span></span><br><span class="line"><span class="attr">            addresses:</span> <span class="string">[192.168.1.1]</span>   <span class="comment"># 设置DNS</span></span><br><span class="line"><span class="attr">    version:</span> <span class="number">2</span></span><br></pre></td></tr></table></figure>
<h1 id="如何查看和设置DNS"><a href="#如何查看和设置DNS" class="headerlink" title="如何查看和设置DNS"></a>如何查看和设置DNS</h1><blockquote>
<p>修改<code>/etc/resolv.conf</code>文件是无效的，该文件每次重启会被自动覆盖</p>
</blockquote>
<p>如果是修改单个网卡的DNS请参见：<a href="#如何设置静态IP地址和DNS">如何设置静态IP地址和DNS</a></p>
<p>如果是设置全局DNS，请编辑<code>sudo vim /etc/systemd/resolved.conf</code>，然后重启<code>systemd-resolved</code>服务<code>sudo systemctl restart systemd-resolved.service</code>即可。</p>
<p>查看当前正在使用的DNS可以使用<code>sudo systemd-resolve --status</code></p>
</div>
        </div>
    </div>
</div>

    </main>
    <script src="/js/jquery-3.3.1.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
</body>
</html>
